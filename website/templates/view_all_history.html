{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <h1 class="mt-5">All Positions' History</h1>

    <form method="GET" class="mb-4">
      <div class="mb-3">
        <label for="position" class="form-label">Filter by Position:</label>
        <select name="position" id="position" class="form-select">
          <option value="">All Positions</option>
          {% for position in positions %}
            <option value="{{ position.id }}">{{ position.position }}</option>
          {% endfor %}
        </select>
      </div>
      <button type="submit" class="btn btn-primary">Apply Filter</button>
    </form>

    <h2>Matched CVs</h2>
    {% for position, matched_cvs in matched_cvs_by_position.items %}
      <h3>Position: {{ position.position }}</h3>
      <table class="table table-striped table-hover table-bordered">
        <thead class="table-dark">
          <tr>
            <th>Name</th>
            <th>Number</th>
            <th>Email</th>
            <th>Date Matched</th>
          </tr>
        </thead>
        <tbody>
          {% for match in matched_cvs %}
            <tr>
              <td>{{ match.cv.name }}</td>
              <td>{{ match.cv.phone }}</td>
              <td>{{ match.cv.email }}</td>
              <td>{{ match.match_date }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </div>
{% endblock %}
